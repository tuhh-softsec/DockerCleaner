{"seed":1515833542,"processedDockerfileHash":"de681d41042ecff2890c6f8cb02d840a","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["do-not-use-apt-get-update-alone","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Copyright 2015 Netflix, Inc.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM netflixoss/tomcat:7\nMAINTAINER Netflix Open Source Development <talent@netflix.com>\n#   Properties to set\nENV CATALINA_OPTS=\"-Dspring.profiles.active=prod -Darchaius.deployment.applicationId=genie -Darchaius.deployment.environment=dev\"\n#   Download and configure the Genie WAR file and Genie Jobs directory where job results will be stored\nRUN wget -q -P /tomcat/webapps 'http://jcenter.bintray.com/com/netflix/genie/genie-web/2.0.0/genie-web-2.0.0.war' \\\n && mkdir /tomcat/webapps/ROOT \\\n && cd /tomcat/webapps/ROOT \\\n && jar xf ../genie-web-2.0.0.war \\\n && cd .. \\\n && rm genie-web-2.0.0.war \\\n && mkdir /tomcat/webapps/genie-jobs \\\n && wget -q -P /tomcat/conf 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/tomcat/conf/listings.xsl' \\\n && sed -i '111s/false/true/' /tomcat/conf/web.xml \\\n && sed -i '113i\\ \\ \\ \\ \\ \\ \\ \\ <init-param>\\n\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ <param-name>globalXsltFile<\\/param-name>\\n\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ <param-value>\\/tomcat\\/conf\\/listings.xsl<\\/param-value>\\n\\ \\ \\ \\ \\ \\ \\ \\ <\\/init-param>' /tomcat/conf/web.xml\n#   Modify the default database properties for the mysql-genie docker link\nRUN mkdir /tmp/genie-server \\\n && cp /tomcat/webapps/ROOT/WEB-INF/lib/genie-server-2.0.0.jar /tmp/genie-server/ \\\n && cd /tmp/genie-server/ \\\n && jar xf genie-server-2.0.0.jar \\\n && rm genie-server-2.0.0.jar \\\n && sed -i '54s/127.0.0.1/mysql-genie/' genie-jpa.xml \\\n && sed -i '56s/value=\"\"/value=\"genie\"/' genie-jpa.xml \\\n && jar cf genie-server-2.0.0.jar * \\\n && mv genie-server-2.0.0.jar /tomcat/webapps/ROOT/WEB-INF/lib/ \\\n && cd /tomcat \\\n && rm -rf /tmp/genie-server\n#   Modify default properties to map to the Docker image locations and settings\nRUN sed -i '22s/7001/8080/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '77s/\\/mnt\\/tomcat\\/genie-jobs/\\/tomcat\\/webapps\\/genie-jobs/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '51s/\\/usr\\/lib\\/jvm\\/java-6-sun/\\/usr\\/lib\\/jvm\\/java-7-oracle/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '54s/\\/apps\\/hadoop\\/current/\\/apps\\/hadoop\\/2.6.0/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '56s/netflix.genie.server.hadoop.2.4.0.home=\\/apps\\/hadoop\\/2.4.0/netflix.genie.server.hadoop.2.6.0.home=\\/apps\\/hadoop\\/2.6.0/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '55d' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '81,86d' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '81inetflix.genie.server.hadoop.s3cp.opts=' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties\n#   Download all the Genie scripts that are used to run jobs\nRUN mkdir -p /apps/genie/bin \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/jobkill.sh' \\\n && chmod 755 /apps/genie/bin/jobkill.sh \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/joblauncher.sh' \\\n && chmod 755 /apps/genie/bin/joblauncher.sh \\\n && sed -i '77s/conf/etc\\/hadoop/' /apps/genie/bin/joblauncher.sh \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/localCleanup.py' \\\n && chmod 755 /apps/genie/bin/localCleanup.py \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/timeout3' \\\n && chmod 755 /apps/genie/bin/timeout3\n#   Below here optional to run Genie and can be different for different deployments\n#   Download and configure hadoop client\nRUN mkdir -p /apps/hadoop/2.6.0 \\\n && cd /apps/hadoop/2.6.0 \\\n && wget -q -P /apps/hadoop/2.6.0 'http://apache.cs.utah.edu/hadoop/common/hadoop-2.6.0/hadoop-2.6.0.tar.gz' \\\n && tar xf hadoop-2.6.0.tar.gz \\\n && rm hadoop-2.6.0.tar.gz \\\n && chown root:root -R hadoop-2.6.0 \\\n && mv hadoop-2.6.0/* . \\\n && rm -rf hadoop-2.6.0\nENV HADOOP_HOME=\"/apps/hadoop/2.6.0\"\nENV HADOOP_PREFIX=\"$HADOOP_HOME\"\nENV PATH=\"$HADOOP_HOME/bin:$PATH\"\n#   This is not needed to get Genie working as the scripts loaded into conf below can be copied at runtime\n#   I'm just adding them here so that all hadoop/pig/hive commands can connect to the cluster from Genie node by default\n#   in case someone wants to mess around with them as a client\nCOPY hadoop/2.6.0/conf/*.xml $HADOOP_HOME/etc/hadoop/\n#   Download and configure pig client\nRUN mkdir -p /apps/pig/0.14.0 \\\n && cd /apps/pig/0.14.0 \\\n && wget -q -P /apps/pig/0.14.0 'http://apache.cs.utah.edu/pig/pig-0.14.0/pig-0.14.0.tar.gz' \\\n && tar xf pig-0.14.0.tar.gz \\\n && rm pig-0.14.0.tar.gz \\\n && chown root:root -R pig-0.14.0 \\\n && mv pig-0.14.0/* . \\\n && rm -rf pig-0.14.0\nENV PIG_HOME=\"/apps/pig/0.14.0\"\nENV PATH=\"$PIG_HOME/bin:$PATH\"\n#   Download and configure hive client\nRUN mkdir -p /apps/hive/1.0.0 \\\n && cd /apps/hive/1.0.0 \\\n && wget -q -P /apps/hive/1.0.0 'http://apache.cs.utah.edu/hive/hive-1.0.0/apache-hive-1.0.0-bin.tar.gz' \\\n && tar xf apache-hive-1.0.0-bin.tar.gz \\\n && rm apache-hive-1.0.0-bin.tar.gz \\\n && chown root:root -R apache-hive-1.0.0-bin \\\n && mv apache-hive-1.0.0-bin/* . \\\n && rm -rf apache-hive-1.0.0-bin\nENV HIVE_HOME=\"/apps/hive/1.0.0\"\nENV PATH=\"$HIVE_HOME/bin:$PATH\"\n#   Install some packages that will be used for the example\nRUN : \\\n && DEBIAN_FRONTEND=noninteractive apt-get -y install python python-pip vim \\\n && python -m pip install --no-input --upgrade --force pip \\\n && pip install nflx-genie-client==2.0.0\n#   Put the example scripts onto the image if people want to use them\nCOPY hadoop/2.6.0/conf/*.xml /apps/genie/hadoop/2.6.0/conf/\nCOPY example/*.py /apps/genie/example/\nEXPOSE 8080/tcp\nENTRYPOINT [\"/tomcat/bin/catalina.sh\"]\nCMD [\"run\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Copyright 2015 Netflix, Inc.\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\nFROM netflixoss/tomcat:7\nMAINTAINER Netflix Open Source Development <talent@netflix.com>\n#  Properties to set\nENV CATALINA_OPTS=\"-Dspring.profiles.active=prod -Darchaius.deployment.applicationId=genie -Darchaius.deployment.environment=dev\"\n#  Download and configure the Genie WAR file and Genie Jobs directory where job results will be stored\nRUN wget -q -P /tomcat/webapps 'http://jcenter.bintray.com/com/netflix/genie/genie-web/2.0.0/genie-web-2.0.0.war' \\\n && mkdir /tomcat/webapps/ROOT \\\n && cd /tomcat/webapps/ROOT \\\n && jar xf ../genie-web-2.0.0.war \\\n && cd .. \\\n && rm genie-web-2.0.0.war \\\n && mkdir /tomcat/webapps/genie-jobs \\\n && wget -q -P /tomcat/conf 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/tomcat/conf/listings.xsl' \\\n && sed -i '111s/false/true/' /tomcat/conf/web.xml \\\n && sed -i '113i\\ \\ \\ \\ \\ \\ \\ \\ <init-param>\\n\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ <param-name>globalXsltFile<\\/param-name>\\n\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ <param-value>\\/tomcat\\/conf\\/listings.xsl<\\/param-value>\\n\\ \\ \\ \\ \\ \\ \\ \\ <\\/init-param>' /tomcat/conf/web.xml\n#  Modify the default database properties for the mysql-genie docker link\nRUN mkdir /tmp/genie-server \\\n && cp /tomcat/webapps/ROOT/WEB-INF/lib/genie-server-2.0.0.jar /tmp/genie-server/ \\\n && cd /tmp/genie-server/ \\\n && jar xf genie-server-2.0.0.jar \\\n && rm genie-server-2.0.0.jar \\\n && sed -i '54s/127.0.0.1/mysql-genie/' genie-jpa.xml \\\n && sed -i '56s/value=\"\"/value=\"genie\"/' genie-jpa.xml \\\n && jar cf genie-server-2.0.0.jar * \\\n && mv genie-server-2.0.0.jar /tomcat/webapps/ROOT/WEB-INF/lib/ \\\n && cd /tomcat \\\n && rm -rf /tmp/genie-server\n#  Modify default properties to map to the Docker image locations and settings\nRUN sed -i '22s/7001/8080/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '77s/\\/mnt\\/tomcat\\/genie-jobs/\\/tomcat\\/webapps\\/genie-jobs/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '51s/\\/usr\\/lib\\/jvm\\/java-6-sun/\\/usr\\/lib\\/jvm\\/java-7-oracle/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '54s/\\/apps\\/hadoop\\/current/\\/apps\\/hadoop\\/2.6.0/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '56s/netflix.genie.server.hadoop.2.4.0.home=\\/apps\\/hadoop\\/2.4.0/netflix.genie.server.hadoop.2.6.0.home=\\/apps\\/hadoop\\/2.6.0/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '55d' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '81,86d' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '81inetflix.genie.server.hadoop.s3cp.opts=' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties\n#  Download all the Genie scripts that are used to run jobs\nRUN mkdir -p /apps/genie/bin \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/jobkill.sh' \\\n && chmod 755 /apps/genie/bin/jobkill.sh \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/joblauncher.sh' \\\n && chmod 755 /apps/genie/bin/joblauncher.sh \\\n && sed -i '77s/conf/etc\\/hadoop/' /apps/genie/bin/joblauncher.sh \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/localCleanup.py' \\\n && chmod 755 /apps/genie/bin/localCleanup.py \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/timeout3' \\\n && chmod 755 /apps/genie/bin/timeout3\n#  Below here optional to run Genie and can be different for different deployments\n#  Download and configure hadoop client\nRUN mkdir -p /apps/hadoop/2.6.0 \\\n && cd /apps/hadoop/2.6.0 \\\n && wget -q -P /apps/hadoop/2.6.0 'http://apache.cs.utah.edu/hadoop/common/hadoop-2.6.0/hadoop-2.6.0.tar.gz' \\\n && tar xf hadoop-2.6.0.tar.gz \\\n && rm hadoop-2.6.0.tar.gz \\\n && chown root:root -R hadoop-2.6.0 \\\n && mv hadoop-2.6.0/* . \\\n && rm -rf hadoop-2.6.0\nENV HADOOP_HOME=\"/apps/hadoop/2.6.0\"\nENV HADOOP_PREFIX=\"$HADOOP_HOME\"\nENV PATH=\"$HADOOP_HOME/bin:$PATH\"\n#  This is not needed to get Genie working as the scripts loaded into conf below can be copied at runtime\n#  I'm just adding them here so that all hadoop/pig/hive commands can connect to the cluster from Genie node by default\n#  in case someone wants to mess around with them as a client\nADD hadoop/2.6.0/conf/*.xml $HADOOP_HOME/etc/hadoop/\n#  Download and configure pig client\nRUN mkdir -p /apps/pig/0.14.0 \\\n && cd /apps/pig/0.14.0 \\\n && wget -q -P /apps/pig/0.14.0 'http://apache.cs.utah.edu/pig/pig-0.14.0/pig-0.14.0.tar.gz' \\\n && tar xf pig-0.14.0.tar.gz \\\n && rm pig-0.14.0.tar.gz \\\n && chown root:root -R pig-0.14.0 \\\n && mv pig-0.14.0/* . \\\n && rm -rf pig-0.14.0\nENV PIG_HOME=\"/apps/pig/0.14.0\"\nENV PATH=\"$PIG_HOME/bin:$PATH\"\n#  Download and configure hive client\nRUN mkdir -p /apps/hive/1.0.0 \\\n && cd /apps/hive/1.0.0 \\\n && wget -q -P /apps/hive/1.0.0 'http://apache.cs.utah.edu/hive/hive-1.0.0/apache-hive-1.0.0-bin.tar.gz' \\\n && tar xf apache-hive-1.0.0-bin.tar.gz \\\n && rm apache-hive-1.0.0-bin.tar.gz \\\n && chown root:root -R apache-hive-1.0.0-bin \\\n && mv apache-hive-1.0.0-bin/* . \\\n && rm -rf apache-hive-1.0.0-bin\nENV HIVE_HOME=\"/apps/hive/1.0.0\"\nENV PATH=\"$HIVE_HOME/bin:$PATH\"\n#  Install some packages that will be used for the example\nRUN apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get -y install python python-pip vim \\\n && python -m pip install --no-input --upgrade --force pip \\\n && pip install nflx-genie-client==2.0.0\n#  Put the example scripts onto the image if people want to use them\nADD hadoop/2.6.0/conf/*.xml /apps/genie/hadoop/2.6.0/conf/\nADD example/*.py /apps/genie/example/\nEXPOSE 8080/tcp\nENTRYPOINT [\"/tomcat/bin/catalina.sh\"]\nCMD [\"run\"]\n","injectedSmells":[],"originalDockerfileHash":"9fce11b0f816cbb34faf24a05a59c8c6","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Copyright 2015 Netflix, Inc.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM netflixoss/tomcat:7\nMAINTAINER Netflix Open Source Development <talent@netflix.com>\n#   Properties to set\nENV CATALINA_OPTS=\"-Dspring.profiles.active=prod -Darchaius.deployment.applicationId=genie -Darchaius.deployment.environment=dev\"\n#   Download and configure the Genie WAR file and Genie Jobs directory where job results will be stored\nRUN wget -q -P /tomcat/webapps 'http://jcenter.bintray.com/com/netflix/genie/genie-web/2.0.0/genie-web-2.0.0.war' \\\n && mkdir /tomcat/webapps/ROOT \\\n && cd /tomcat/webapps/ROOT \\\n && jar xf ../genie-web-2.0.0.war \\\n && cd .. \\\n && rm genie-web-2.0.0.war \\\n && mkdir /tomcat/webapps/genie-jobs \\\n && wget -q -P /tomcat/conf 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/tomcat/conf/listings.xsl' \\\n && sed -i '111s/false/true/' /tomcat/conf/web.xml \\\n && sed -i '113i\\ \\ \\ \\ \\ \\ \\ \\ <init-param>\\n\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ <param-name>globalXsltFile<\\/param-name>\\n\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ <param-value>\\/tomcat\\/conf\\/listings.xsl<\\/param-value>\\n\\ \\ \\ \\ \\ \\ \\ \\ <\\/init-param>' /tomcat/conf/web.xml\n#   Modify the default database properties for the mysql-genie docker link\nRUN mkdir /tmp/genie-server \\\n && cp /tomcat/webapps/ROOT/WEB-INF/lib/genie-server-2.0.0.jar /tmp/genie-server/ \\\n && cd /tmp/genie-server/ \\\n && jar xf genie-server-2.0.0.jar \\\n && rm genie-server-2.0.0.jar \\\n && sed -i '54s/127.0.0.1/mysql-genie/' genie-jpa.xml \\\n && sed -i '56s/value=\"\"/value=\"genie\"/' genie-jpa.xml \\\n && jar cf genie-server-2.0.0.jar * \\\n && mv genie-server-2.0.0.jar /tomcat/webapps/ROOT/WEB-INF/lib/ \\\n && cd /tomcat \\\n && rm -rf /tmp/genie-server\n#   Modify default properties to map to the Docker image locations and settings\nRUN sed -i '22s/7001/8080/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '77s/\\/mnt\\/tomcat\\/genie-jobs/\\/tomcat\\/webapps\\/genie-jobs/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '51s/\\/usr\\/lib\\/jvm\\/java-6-sun/\\/usr\\/lib\\/jvm\\/java-7-oracle/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '54s/\\/apps\\/hadoop\\/current/\\/apps\\/hadoop\\/2.6.0/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '56s/netflix.genie.server.hadoop.2.4.0.home=\\/apps\\/hadoop\\/2.4.0/netflix.genie.server.hadoop.2.6.0.home=\\/apps\\/hadoop\\/2.6.0/' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '55d' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '81,86d' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties \\\n && sed -i '81inetflix.genie.server.hadoop.s3cp.opts=' /tomcat/webapps/ROOT/WEB-INF/classes/genie.properties\n#   Download all the Genie scripts that are used to run jobs\nRUN mkdir -p /apps/genie/bin \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/jobkill.sh' \\\n && chmod 755 /apps/genie/bin/jobkill.sh \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/joblauncher.sh' \\\n && chmod 755 /apps/genie/bin/joblauncher.sh \\\n && sed -i '77s/conf/etc\\/hadoop/' /apps/genie/bin/joblauncher.sh \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/localCleanup.py' \\\n && chmod 755 /apps/genie/bin/localCleanup.py \\\n && wget -q -P /apps/genie/bin 'https://raw.githubusercontent.com/Netflix/genie/2.0.0/genie-web/conf/system/apps/genie/bin/timeout3' \\\n && chmod 755 /apps/genie/bin/timeout3\n#   Below here optional to run Genie and can be different for different deployments\n#   Download and configure hadoop client\nRUN mkdir -p /apps/hadoop/2.6.0 \\\n && cd /apps/hadoop/2.6.0 \\\n && wget -q -P /apps/hadoop/2.6.0 'http://apache.cs.utah.edu/hadoop/common/hadoop-2.6.0/hadoop-2.6.0.tar.gz' \\\n && tar xf hadoop-2.6.0.tar.gz \\\n && rm hadoop-2.6.0.tar.gz \\\n && chown root:root -R hadoop-2.6.0 \\\n && mv hadoop-2.6.0/* . \\\n && rm -rf hadoop-2.6.0\nENV HADOOP_HOME=\"/apps/hadoop/2.6.0\"\nENV HADOOP_PREFIX=\"$HADOOP_HOME\"\nENV PATH=\"$HADOOP_HOME/bin:$PATH\"\n#   This is not needed to get Genie working as the scripts loaded into conf below can be copied at runtime\n#   I'm just adding them here so that all hadoop/pig/hive commands can connect to the cluster from Genie node by default\n#   in case someone wants to mess around with them as a client\nADD hadoop/2.6.0/conf/*.xml $HADOOP_HOME/etc/hadoop/\n#   Download and configure pig client\nRUN mkdir -p /apps/pig/0.14.0 \\\n && cd /apps/pig/0.14.0 \\\n && wget -q -P /apps/pig/0.14.0 'http://apache.cs.utah.edu/pig/pig-0.14.0/pig-0.14.0.tar.gz' \\\n && tar xf pig-0.14.0.tar.gz \\\n && rm pig-0.14.0.tar.gz \\\n && chown root:root -R pig-0.14.0 \\\n && mv pig-0.14.0/* . \\\n && rm -rf pig-0.14.0\nENV PIG_HOME=\"/apps/pig/0.14.0\"\nENV PATH=\"$PIG_HOME/bin:$PATH\"\n#   Download and configure hive client\nRUN mkdir -p /apps/hive/1.0.0 \\\n && cd /apps/hive/1.0.0 \\\n && wget -q -P /apps/hive/1.0.0 'http://apache.cs.utah.edu/hive/hive-1.0.0/apache-hive-1.0.0-bin.tar.gz' \\\n && tar xf apache-hive-1.0.0-bin.tar.gz \\\n && rm apache-hive-1.0.0-bin.tar.gz \\\n && chown root:root -R apache-hive-1.0.0-bin \\\n && mv apache-hive-1.0.0-bin/* . \\\n && rm -rf apache-hive-1.0.0-bin\nENV HIVE_HOME=\"/apps/hive/1.0.0\"\nENV PATH=\"$HIVE_HOME/bin:$PATH\"\n#   Install some packages that will be used for the example\nRUN apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get -y install python python-pip vim \\\n && python -m pip install --no-input --upgrade --force pip \\\n && pip install nflx-genie-client==2.0.0\n#   Put the example scripts onto the image if people want to use them\nADD hadoop/2.6.0/conf/*.xml /apps/genie/hadoop/2.6.0/conf/\nADD example/*.py /apps/genie/example/\nEXPOSE 8080/tcp\nENTRYPOINT [\"/tomcat/bin/catalina.sh\"]\nCMD [\"run\"]\n","originalDockerfileUglifiedHash":"9918c64ff5ab8413234bad35eb06446c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/61514d157474180b5a61109ecca24462fd93d6c9.dockerfile"}